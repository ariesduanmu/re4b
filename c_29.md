This is a very short program, compiled using the patched Tiny C compiler. Try to find out what it does.

```assembly
004010A0  PUSH EBP
004010A1  MOV EBP,ESP
004010A7  ADD BYTE PTR DS:[EAX],AL
004010A9  NOP
004010AA  MOV EAX,DWORD PTR DS:[406054]
004010B0  SHR EAX,0                                ;  Shift constant out of range 1..31
004010B3  SHR EAX,1
004010B6  XOR EAX,A8F3A9CA
004010BC  SHL EAX,7
004010BF  SUB EAX,5A041880
004010C5  MOV DWORD PTR SS:[EBP-14],EAX
004010C8  MOV EAX,DWORD PTR DS:[406060]
004010CE  ADD EAX,CD56CED8
004010D4  ADD EAX,2D31D041
004010DA  ADD EAX,41B2E191
004010E0  SUB EAX,0DD00293
004010E6  PUSH EAX                                 ; /CWmask
004010E7  MOV EAX,DWORD PTR DS:[40604C]            ; |
004010ED  ADD EAX,83E47573                         ; |
004010F3  SHR EAX,1                                ; |
004010F6  SHR EAX,7                                ; |
004010F9  SUB EAX,68D84F                           ; |
004010FF  PUSH EAX                                 ; |CWnew
00401100  CALL <JMP.&msvcrt._controlfp>            ; \_controlfp
00401105  ADD ESP,8
00401108  ADC ECX,EBX
0040110A  MOV EAX,DWORD PTR DS:[40605C]
00401110  XOR EAX,E5969654
00401116  SUB EAX,7F3658C1
0040111C  ADD EAX,4EF4C3
00401122  ADD EAX,BFD080BE
00401128  SUB EAX,FD778E3E
0040112E  PUSH EAX
0040112F  CALL <JMP.&msvcrt.__set_app_type>
00401134  ADD ESP,4
00401137  SUB ECX,EDX
00401139  OR ECX,EDX
0040113B  XOR EDX,ECX
0040113D  SUB EDX,ECX
0040113F  LEA ECX,DWORD PTR DS:[EDX-80]
00401142  MOV EDX,159541F2
00401147  MOV ECX,5FBD2DC
0040114C  MOV EBX,60C7560D
00401151  MOV EDX,9101B787
00401156  ADD EBX,EBX
00401158  SUB EDX,EAX
0040115A  OR ECX,EDX
0040115C  XOR EBX,EDX
0040115E  LEA EBX,DWORD PTR DS:[EDX]
00401160  LEA EDX,DWORD PTR DS:[EAX-7C]
00401163  LEA EBX,DWORD PTR DS:[EAX]
00401165  SUB ECX,EBX
00401167  XOR EDX,EAX
00401169  LEA EAX,DWORD PTR SS:[EBP-14]
0040116C  PUSH EAX
0040116D  MOV EAX,DWORD PTR DS:[406064]
00401173  SHR EAX,1
00401176  ADD EAX,7098B976
0040117C  XOR EAX,EC04BB59
00401182  SUB EAX,3541BD00
00401188  PUSH EAX
00401189  LEA EAX,DWORD PTR SS:[EBP-C]
0040118C  PUSH EAX
0040118D  LEA EAX,DWORD PTR SS:[EBP-8]
00401190  PUSH EAX
00401191  LEA EAX,DWORD PTR SS:[EBP-4]
00401194  PUSH EAX
00401195  CALL <JMP.&msvcrt.__getmainargs>
0040119A  ADD ESP,14
0040119D  MOV EBX,37CAB363
004011A2  MOV ECX,CF8A6F78
004011A7  ADD ECX,EAX
004011A9  XOR EDX,EAX
004011AB  ADC EBX,ECX
004011AD  ADD EDX,EDX
004011AF  LEA ECX,DWORD PTR DS:[EBX]
004011B1  MOV EDX,C16D8EFA
004011B6  OR ECX,EBX
004011B8  MOV EDX,322DE4A6
004011BD  MOV EBX,6FBE8FA3
004011C2  LEA ECX,DWORD PTR SS:[EBP+DC63C429]
004011C8  ADD EBX,EAX
004011CA  MOV EAX,DWORD PTR SS:[EBP-C]
004011CD  PUSH EAX
004011CE  MOV EAX,DWORD PTR SS:[EBP-8]
004011D1  PUSH EAX
004011D2  MOV EAX,DWORD PTR SS:[EBP-4]
004011D5  PUSH EAX
004011D6  CALL obfuscat.0040106A
004011DB  ADD ESP,0C
004011DE  MOV EBX,DWORD PTR SS:[EBP-10]
004011E1  SBB EBX,EDX
004011E3  OR EBX,EAX
004011E5  MOV EBX,DWORD PTR SS:[EBP-10]
004011E8  OR EBX,EDX
004011EA  MOV ECX,6E1835EF
004011EF  ADD EBX,EAX
004011F1  MOV ECX,DWORD PTR SS:[EBP-10]
004011F4  SUB ECX,EDX
004011F6  LEA EBX,DWORD PTR DS:[EDX]
004011F8  OR EBX,EDX
004011FA  MOV ECX,DWORD PTR SS:[EBP-10]
004011FD  ADC ECX,EDX
004011FF  ADD ECX,ECX
00401201  ADC EBX,EBX
00401203  LEA ECX,DWORD PTR DS:[EDX-7D]
00401206  LEA ECX,DWORD PTR DS:[EDX-56]
00401209  MOV ECX,801E887F
0040120E  MOV EBX,BB1821F0
00401213  LEA EBX,DWORD PTR DS:[ECX+49]
00401216  MOV ECX,DWORD PTR SS:[EBP-10]
00401219  ADD ECX,EAX
0040121B  ADC EDX,EAX
0040121D  LEA EBX,DWORD PTR DS:[EDI+934C3E31]
00401223  MOV DWORD PTR SS:[EBP-10],EAX
00401226  MOV EAX,DWORD PTR SS:[EBP-10]
00401229  PUSH EAX                                 ; /status
0040122A  CALL <JMP.&msvcrt.exit>                  ; \exit
0040122F  ADD ESP,4
00401232  MOV EBX,1D59E206
00401237  MOV ECX,13414EE9
0040123C  LEA ECX,DWORD PTR DS:[ESI+9C3764EF]
00401242  ADD EBX,ECX
00401244  ADD EDX,EBX
00401246  MOV EDX,C04A8DF2
0040124B  MOV EBX,BBA98267
00401250  ADD EBX,EBX
00401252  XOR EBX,ECX
00401254  MOV EBX,52C60BBC
00401259  MOV EBX,AF271162
0040125E  SBB EBX,EAX
00401260  MOV EBX,95CB9BC2
00401265  XOR EDX,EAX
00401267  MOV EBX,6B6C4CCB
0040126C  SUB ECX,EAX
0040126E  SBB EBX,EAX
00401270  AND ECX,EBX
00401272  SUB EDX,EDX
00401274  JNZ SHORT obfuscat.00401216
00401276  LEAVE
00401277  RETN
```

```
0040106A  PUSH EBP
0040106B  MOV EBP,ESP
0040106D  SUB ESP,0
00401073  NOP
00401074  MOV EAX,89
00401079  PUSH EAX
0040107A  CALL obfuscat.00401000
0040107F  ADD ESP,4
00401082  PUSH EAX                                 ; /<%d>
00401083  MOV EAX,obfuscat.00406000                ; |ASCII "%d"
00401088  PUSH EAX                                 ; |format => "%d"
00401089  CALL <JMP.&msvcrt.printf>                ; \printf
0040108E  ADD ESP,8
00401091  LEAVE
00401092  RETN

```

```
00401000  PUSH EBP
00401001  MOV EBP,ESP
00401003  SUB ESP,4
00401009  NOP
0040100A  MOV EAX,2
0040100F  MOV DWORD PTR SS:[EBP-4],EAX
00401012  MOV EAX,DWORD PTR SS:[EBP-4]
00401015  MOV ECX,DWORD PTR SS:[EBP+8]
00401018  CMP EAX,ECX
0040101A  JGE obfuscat.0040105E
00401020  JMP obfuscat.00401032
00401025  MOV EAX,DWORD PTR SS:[EBP-4]
00401028  MOV ECX,EAX
0040102A  ADD EAX,1
0040102D  MOV DWORD PTR SS:[EBP-4],EAX
00401030  JMP SHORT obfuscat.00401012
00401032  MOV EAX,DWORD PTR SS:[EBP+8]
00401035  MOV ECX,DWORD PTR SS:[EBP-4]
00401038  CDQ
00401039  IDIV ECX
0040103B  CMP EDX,0
0040103E  JNZ obfuscat.0040105C
00401044  MOV EAX,DWORD PTR SS:[EBP-4]
00401047  MOV ECX,DWORD PTR SS:[EBP+8]
0040104A  CMP EAX,ECX
0040104C  JE obfuscat.0040105C
00401052  MOV EAX,0
00401057  JMP obfuscat.00401068
0040105C  JMP SHORT obfuscat.00401025
0040105E  MOV EAX,1
00401063  JMP obfuscat.00401068
00401068  LEAVE
00401069  RETN


```
---

## Answer

```assembly
004010A0  PUSH EBP
004010A1  MOV EBP,ESP
004010A7  ADD BYTE PTR DS:[EAX],AL
004010A9  NOP
004010AA  MOV EAX,DWORD PTR DS:[406054] ; eax=0xC88F43F7
004010B0  SHR EAX,0                               
004010B3  SHR EAX,1 ; eax=0x6447A1FB
004010B6  XOR EAX,A8F3A9CA ; eax=0xCCB40831
004010BC  SHL EAX,7 ; eax=0x5A041880
004010BF  SUB EAX,5A041880 ; eax=0 *garbage above*
004010C5  MOV DWORD PTR SS:[EBP-14],EAX ; ebp=0
004010C8  MOV EAX,DWORD PTR DS:[406060] ; eax=0xD19781E9
004010CE  ADD EAX,CD56CED8 ; eax=0x9EEE50C1
004010D4  ADD EAX,2D31D041 ; eax=0xCC202102
004010DA  ADD EAX,41B2E191 ; eax=0x0DD30293
004010E0  SUB EAX,0DD00293 ; eax=0x00030000 
004010E6  PUSH EAX ; 栈位0x0012FFA8=0x00030000                            
004010E7  MOV EAX,DWORD PTR DS:[40604C] ; eax=0xE5F30A1C           
004010ED  ADD EAX,83E47573 ; eax=0x69D84F8F                        
004010F3  SHR EAX,1                                
004010F6  SHR EAX,7 ; eax=0x0069D84F                               
004010F9  SUB EAX,68D84F ; eax=0x00010000                         
004010FF  PUSH EAX ; 栈位0x0012FFA4=0x00010000                               
00401100  CALL <JMP.&msvcrt._controlfp>  ;eax=0x0009001F ecx=0x0000023F edx=0x00000300          
00401105  ADD ESP,8 ; clean two stack
00401108  ADC ECX,EBX ; ecx = 0x7FFDA23F
0040110A  MOV EAX,DWORD PTR DS:[40605C] ; eax=0x5918E72B
00401110  XOR EAX,E5969654 ; eax=0xBC8E717F
00401116  SUB EAX,7F3658C1 ; eax=0x3D5818BE
0040111C  ADD EAX,4EF4C3 ; eax=0x3DA70D81
00401122  ADD EAX,BFD080BE ; eax=0xFD778E3F
00401128  SUB EAX,FD778E3E ; eax=1
0040112E  PUSH EAX ; 栈位0x0012FFA8=1
0040112F  CALL <JMP.&msvcrt.__set_app_type>
00401134  ADD ESP,4 ; clean 1 stack
00401137  SUB ECX,EDX ; ecx=0x7FFD9F3F
00401139  OR ECX,EDX
0040113B  XOR EDX,ECX ; edx=0x7FFD9F3F
0040113D  SUB EDX,ECX ; edx=0xFFFFFD00
0040113F  LEA ECX,DWORD PTR DS:[EDX-80] ; ecx=0xFFFFFC80
00401142  MOV EDX,159541F2 ; edx=0x159541F2
00401147  MOV ECX,5FBD2DC ; ecx=0x05FBD2DC
0040114C  MOV EBX,60C7560D ; ebx=0x60C7560D
00401151  MOV EDX,9101B787 ; edx=0x9101B787
00401156  ADD EBX,EBX ; ebx=0xC18EAC1A
00401158  SUB EDX,EAX ; edx=0x9101B786
0040115A  OR ECX,EDX ; ecx=0x95FBF7DE
0040115C  XOR EBX,EDX ; ebx=0x508F1B9C
0040115E  LEA EBX,DWORD PTR DS:[EDX] ; ebx=0x9101B786
00401160  LEA EDX,DWORD PTR DS:[EAX-7C] ; edx=0xffffff85
00401163  LEA EBX,DWORD PTR DS:[EAX] ; ebx=1
00401165  SUB ECX,EBX ; ecx=0x95FBF7DD
00401167  XOR EDX,EAX ; edx=0xffffff84
00401169  LEA EAX,DWORD PTR SS:[EBP-14] ; eax=0x0012FFAC
0040116C  PUSH EAX ; 栈位0x0012FFA8=0x0012FFAC
0040116D  MOV EAX,DWORD PTR DS:[406064] ; eax=0xD15899C6
00401173  SHR EAX,1
00401176  ADD EAX,7098B976
0040117C  XOR EAX,EC04BB59
00401182  SUB EAX,3541BD00 ; eax=0
00401188  PUSH EAX ; 栈位0x0012FFA4=0
00401189  LEA EAX,DWORD PTR SS:[EBP-C]
0040118C  PUSH EAX ; 栈位0x0012FFA0=0x0012FFB4
0040118D  LEA EAX,DWORD PTR SS:[EBP-8]
00401190  PUSH EAX ; 栈位0x0012FF9C=0x0012FFB8
00401191  LEA EAX,DWORD PTR SS:[EBP-4]
00401194  PUSH EAX ; 栈位0x0012FF98=0x0012FFBC
00401195  CALL <JMP.&msvcrt.__getmainargs> ; Invokes command-line parsing and copies the arguments to main() back through the passed pointers. eax=0 ecx=0x0012FFB4 edx=0x00382A18
0040119A  ADD ESP,14 ; clean 5 stack
0040119D  MOV EBX,37CAB363
004011A2  MOV ECX,CF8A6F78
004011A7  ADD ECX,EAX
004011A9  XOR EDX,EAX
004011AB  ADC EBX,ECX ; ebx=0x075522DB
004011AD  ADD EDX,EDX ; edx=0x00705430
004011AF  LEA ECX,DWORD PTR DS:[EBX] ; ecx=0x075522DB
004011B1  MOV EDX,C16D8EFA
004011B6  OR ECX,EBX ;
004011B8  MOV EDX,322DE4A6
004011BD  MOV EBX,6FBE8FA3
004011C2  LEA ECX,DWORD PTR SS:[EBP+DC63C429] ; edx=0xDC76C3E9
004011C8  ADD EBX,EAX ; ebx=0x6FBE8FA3
004011CA  MOV EAX,DWORD PTR SS:[EBP-C]
004011CD  PUSH EAX ;栈位0x0012FFA8=0x00382A18
004011CE  MOV EAX,DWORD PTR SS:[EBP-8]
004011D1  PUSH EAX ;栈位0x0012FFA4=0x00382470
004011D2  MOV EAX,DWORD PTR SS:[EBP-4]
004011D5  PUSH EAX ;栈位0x0012FFA0=0x00000001
004011D6  CALL obfuscat.0040106A ; printf("%d", eax=1);
004011DB  ADD ESP,0C
004011DE  MOV EBX,DWORD PTR SS:[EBP-10]
004011E1  SBB EBX,EDX
004011E3  OR EBX,EAX
004011E5  MOV EBX,DWORD PTR SS:[EBP-10]
004011E8  OR EBX,EDX
004011EA  MOV ECX,6E1835EF
004011EF  ADD EBX,EAX
004011F1  MOV ECX,DWORD PTR SS:[EBP-10]
004011F4  SUB ECX,EDX
004011F6  LEA EBX,DWORD PTR DS:[EDX]
004011F8  OR EBX,EDX
004011FA  MOV ECX,DWORD PTR SS:[EBP-10]
004011FD  ADC ECX,EDX
004011FF  ADD ECX,ECX
00401201  ADC EBX,EBX
00401203  LEA ECX,DWORD PTR DS:[EDX-7D]
00401206  LEA ECX,DWORD PTR DS:[EDX-56]
00401209  MOV ECX,801E887F
0040120E  MOV EBX,BB1821F0
00401213  LEA EBX,DWORD PTR DS:[ECX+49]
00401216  MOV ECX,DWORD PTR SS:[EBP-10]
00401219  ADD ECX,EAX
0040121B  ADC EDX,EAX
0040121D  LEA EBX,DWORD PTR DS:[EDI+934C3E31]
00401223  MOV DWORD PTR SS:[EBP-10],EAX
00401226  MOV EAX,DWORD PTR SS:[EBP-10]
00401229  PUSH EAX                                 
0040122A  CALL <JMP.&msvcrt.exit> * ; this exit work, below all garbage, and only opearaters about registers above, no output

0040122F  ADD ESP,4
00401232  MOV EBX,1D59E206
00401237  MOV ECX,13414EE9
0040123C  LEA ECX,DWORD PTR DS:[ESI+9C3764EF]
00401242  ADD EBX,ECX
00401244  ADD EDX,EBX
00401246  MOV EDX,C04A8DF2
0040124B  MOV EBX,BBA98267
00401250  ADD EBX,EBX
00401252  XOR EBX,ECX
00401254  MOV EBX,52C60BBC
00401259  MOV EBX,AF271162
0040125E  SBB EBX,EAX
00401260  MOV EBX,95CB9BC2
00401265  XOR EDX,EAX
00401267  MOV EBX,6B6C4CCB
0040126C  SUB ECX,EAX
0040126E  SBB EBX,EAX
00401270  AND ECX,EBX
00401272  SUB EDX,EDX
00401274  JNZ SHORT obfuscat.00401216
00401276  LEAVE
00401277  RETN
```

```assembly
0040106A  PUSH EBP
0040106B  MOV EBP,ESP
0040106D  SUB ESP,0
00401073  NOP
00401074  MOV EAX,89
00401079  PUSH EAX ; eax=0x89
0040107A  CALL obfuscat.00401000 * ; eax=1 
0040107F  ADD ESP,4 ; clean stack
00401082  PUSH EAX                                 ; /<%d>
00401083  MOV EAX,obfuscat.00406000 *              ; |ASCII "%d"
00401088  PUSH EAX    *                            ; |format => "%d"
00401089  CALL <JMP.&msvcrt.printf>  *             ; \printf printf("%d", eax);
0040108E  ADD ESP,8
00401091  LEAVE
00401092  RETN

```

This is a meaningless loop... `0040105E  MOV EAX,1` is the only effective code 

```assembly
00401000  PUSH EBP
00401001  MOV EBP,ESP
00401003  SUB ESP,4
00401009  NOP
0040100A  MOV EAX,2
0040100F  MOV DWORD PTR SS:[EBP-4],EAX
00401012  MOV EAX,DWORD PTR SS:[EBP-4] ; eax=0x2 ->0x3 
00401015  MOV ECX,DWORD PTR SS:[EBP+8] ; ecx=0x89 
00401018  CMP EAX,ECX ; if 0x2==0x89
0040101A  JGE obfuscat.0040105E
00401020  JMP obfuscat.00401032 ; jump
00401025  MOV EAX,DWORD PTR SS:[EBP-4] ; eax=2
00401028  MOV ECX,EAX
0040102A  ADD EAX,1 ; eax=3
0040102D  MOV DWORD PTR SS:[EBP-4],EAX ; 0x12ff88=3
00401030  JMP SHORT obfuscat.00401012
00401032  MOV EAX,DWORD PTR SS:[EBP+8] ; eax=0x89
00401035  MOV ECX,DWORD PTR SS:[EBP-4] ; ecx=0x2
00401038  CDQ
00401039  IDIV ECX ; eax= eax/ecx= 0x44
0040103B  CMP EDX,0
0040103E  JNZ obfuscat.0040105C ; jump
00401044  MOV EAX,DWORD PTR SS:[EBP-4]
00401047  MOV ECX,DWORD PTR SS:[EBP+8]
0040104A  CMP EAX,ECX
0040104C  JE obfuscat.0040105C
00401052  MOV EAX,0
00401057  JMP obfuscat.00401068
0040105C  JMP SHORT obfuscat.00401025 ; jump
0040105E  MOV EAX,1 * 
00401063  JMP obfuscat.00401068
00401068  LEAVE
00401069  RETN


```

```c
#include <stdio.h>
int main(){
	int i = 0;
	printf("%d", i);
}
```